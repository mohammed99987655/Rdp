name: RDP via Pinggy

on: 
  workflow_dispatch:

jobs:
  rdp:
    runs-on: windows-latest

    steps:
    - name: ØªÙØ¹ÙŠÙ„ Remote Desktop
      run: |
        Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
        Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
        Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "UserAuthentication" -Value 1
        net user mohammed999 Mohammed@1234 /add
        net localgroup administrators mohammed999 /add

    - name: ØªØ«Ø¨ÙŠØª Google Chrome
      run: |
        Invoke-WebRequest "https://dl.google.com/chrome/install/latest/chrome_installer.exe" -OutFile "chrome_installer.exe"
        Start-Process ".\chrome_installer.exe" -Args "/silent /install" -Wait
        Remove-Item "chrome_installer.exe"

    - name: ØªØ´ØºÙŠÙ„ Pinggy Ø¹Ø¨Ø± SSH ÙˆØ·Ø¨Ø§Ø¹Ø© Ø±Ø§Ø¨Ø· Ø§Ù„Ø§ØªØµØ§Ù„
      shell: bash
      run: |
        echo "ğŸ” Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Remote Desktop:"
        echo "ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: mohammed999"
        echo "ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: Mohammed@1234"
        echo "â³ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†ÙÙ‚ Pinggy..."

        ssh -p 443 -R 0:localhost:3389 -o StrictHostKeyChecking=no -o ServerAliveInterval=30 6PJwxLEUlPO+tcp@ap.free.pinggy.io | tee pinggy_log.txt &
        
        sleep 10
        echo "ğŸŒ Ø±Ø§Ø¨Ø· Ø§Ù„Ø§ØªØµØ§Ù„:"
        grep -i "tcp://" pinggy_log.txt || echo "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø·."
        
        echo "ğŸ•’ Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ù„Ù…Ø¯Ø© Ø³Ø§Ø¹Ø© (60 Ø¯Ù‚ÙŠÙ‚Ø©)..."
        sleep 3600
